!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=Array(t);a<t;a++)r[a]=e[a];return r}var t=function(){var t;function a(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),this.board=this.getState(),this.score=0,this.gameActive=!1,this.cells=document.querySelectorAll(".field-cell"),this.messageWin=document.querySelector(".message-win"),this.messageLose=document.querySelector(".message-lose"),this.assignDataAttributes()}return t=[{key:"assignDataAttributes",value:function(){this.cells.forEach(function(e,t){var a=Math.floor(t/4);e.dataset.row=a,e.dataset.col=t%4})}},{key:"moveUp",value:function(){if(this.gameActive){for(var e=!1,t=0;t<4;t++)this.moveColumnUp(t)&&(e=!0);e&&(this.getRandomTile(),this.addCell()),this.checkGameStatus()}}},{key:"moveDown",value:function(){if(this.gameActive){for(var e=!1,t=0;t<4;t++)this.moveColumnDown(t)&&(e=!0);e&&(this.getRandomTile(),this.addCell()),this.checkGameStatus()}}},{key:"moveLeft",value:function(){if(this.gameActive){for(var e=!1,t=0;t<4;t++)this.moveColumnLeft(t)&&(e=!0);e&&(this.getRandomTile(),this.addCell()),this.checkGameStatus()}}},{key:"moveRight",value:function(){if(this.gameActive){for(var e=!1,t=0;t<4;t++)this.moveColumnRight(t)&&(e=!0);e&&(this.getRandomTile(),this.addCell()),this.checkGameStatus()}}},{key:"getScore",value:function(){return this.board.flat().reduce(function(e,t){return e+t},0)}},{key:"getState",value:function(){var t;return((function(t){if(Array.isArray(t))return e(t)})(t=[,,,,])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,a){if(t){if("string"==typeof t)return e(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(){return[,,,,].fill(0)})}},{key:"getRandomTile",value:function(){for(var e=[],t=0;t<4;t++)for(var a=0;a<4;a++)0===this.board[t][a]&&e.push({row:t,col:a});if(e.length){var r=e[Math.floor(Math.random()*e.length)],n=r.row,i=r.col;return this.board[n][i]=.9>Math.random()?2:4,this.animateNewTile(n,i),{row:n,col:i,value:this.board[n][i]}}return null}},{key:"checkWin",value:function(){return this.board.flat().includes(2048)}},{key:"checkLose",value:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++){if(0===this.board[e][t])return!1;var a=t<3&&this.board[e][t]===this.board[e][t+1],r=e<3&&this.board[e][t]===this.board[e+1][t];if(a||r)return!1}return!0}},{key:"getStatus",value:function(){return this.checkWin()?"win":this.checkLose()?"lose":"playing"}},{key:"checkGameStatus",value:function(){var e=this.getStatus();"win"===e?this.messageWin.classList.remove("hidden"):"lose"===e&&this.messageLose.classList.remove("hidden")}},{key:"addCell",value:function(){var e=this;this.cells.forEach(function(t,a){var r=Math.floor(a/4),n=a%4,i=e.board[r][n];t.className="field-cell"+(i?" field-cell--".concat(i):""),t.textContent=i||"",e.animateAppear(r,n)})}},{key:"deleteCell",value:function(){this.cells.forEach(function(e){e.className="field-cell",e.textContent=""})}},{key:"start",value:function(e){var t=this;this.gameActive=!0,this.score=0,e.classList.replace("start","restart"),e.textContent="Restart",setTimeout(function(){t.getRandomTile(),t.getRandomTile(),t.addCell(),t.assignDataAttributes()},100)}},{key:"restart",value:function(e){this.gameActive=!1,this.score=0;var t=this.messageLose.classList.contains("hidden"),a=this.messageWin.classList.contains("hidden");t||this.messageLose.classList.add("hidden"),a||this.messageWin.classList.add("hidden"),e.classList.replace("restart","start"),e.textContent="Start",this.board=this.getState(),this.deleteCell(),this.assignDataAttributes()}},{key:"moveColumnUp",value:function(e){for(var t=!1,a=this.board.map(function(t){return t[e]}).filter(function(e){return 0!==e}),r=0;r<a.length-1;r++)a[r]===a[r+1]&&(a[r]*=2,a.splice(r+1,1),this.score+=a[r],this.animateMerge(r,e),t=!0);for(;a.length<4;)a.push(0);for(var n=0;n<4;n++)this.board[n][e]!==a[n]&&(t=!0),this.board[n][e]=a[n],this.animateMove(n,e);return t}},{key:"moveColumnDown",value:function(e){for(var t=!1,a=this.board.map(function(t){return t[e]}).filter(function(e){return 0!==e}),r=a.length-1;r>0;r--)a[r]===a[r-1]&&(a[r]*=2,a.splice(r-1,1),this.score+=a[r],this.animateMerge(r,e),t=!0);for(;a.length<4;)a.unshift(0);for(var n=0;n<4;n++)this.board[n][e]!==a[n]&&(t=!0),this.board[n][e]=a[n],this.animateMove(n,e);return t}},{key:"moveColumnLeft",value:function(e){for(var t=!1,a=this.board[e].filter(function(e){return 0!==e}),r=0;r<a.length-1;r++)a[r]===a[r+1]&&(a[r]*=2,a.splice(r+1,1),this.score+=a[r],this.animateMerge(e,r),t=!0);for(;a.length<4;)a.push(0);this.board[e].some(function(e,t){return e!==a[t]})&&(t=!0),this.board[e]=a;for(var n=0;n<4;n++)this.animateMove(e,n);return t}},{key:"moveColumnRight",value:function(e){for(var t=!1,a=this.board[e].filter(function(e){return 0!==e}),r=a.length-1;r>0;r--)a[r]===a[r-1]&&(a[r]*=2,a.splice(r-1,1),this.score+=a[r],this.animateMerge(e,r),t=!0);for(;a.length<4;)a.unshift(0);this.board[e].some(function(e,t){return e!==a[t]})&&(t=!0),this.board[e]=a;for(var n=0;n<4;n++)this.animateMove(e,n);return t}},{key:"animateNewTile",value:function(e,t){var a=document.querySelector('.field-cell[data-row="'.concat(e,'"][data-col="').concat(t,'"]'));a&&(a.classList.add("field-cell--new"),setTimeout(function(){a.classList.remove("field-cell--new")},300))}},{key:"animateAppear",value:function(e,t){var a=document.querySelector('.field-cell[data-row="'.concat(e,'"][data-col="').concat(t,'"]'));a&&(a.classList.add("field-cell--appear"),setTimeout(function(){a.classList.remove("field-cell--appear")},200))}},{key:"animateMerge",value:function(e,t){var a=document.querySelector('.field-cell[data-row="'.concat(e,'"][data-col="').concat(t,'"]'));a&&(a.classList.add("field-cell--merge"),setTimeout(function(){a.classList.remove("field-cell--merge")},300))}},{key:"animateMove",value:function(e,t){var a=document.querySelector('.field-cell[data-row="'.concat(e,'"][data-col="').concat(t,'"]'));a&&(a.classList.add("field-cell--move"),setTimeout(function(){a.classList.remove("field-cell--move")},300))}}],function(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(a.prototype,t),a}();document.addEventListener("DOMContentLoaded",function(){var e=new t,a=document.querySelector(".button"),r=document.querySelector(".game-score"),n=document.querySelector(".message-start"),i=function(){return window.addEventListener("keydown",s,{once:!0})},o=function(){r.textContent=e.getScore()},s=function(t){switch(t.key){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;default:i();return}o(),i()};i(),a.addEventListener("click",function(){if(a.classList.contains("start"))e.start(a),n.classList.add("hidden");else{if(!confirm("Are you sure you want to start a new game? All progress will be lost."))return;e.restart(a),e.start(a)}o(),i()})})}();
//# sourceMappingURL=index.61c2c5d8.js.map
